# AI-Native æ”¹è¿›å»ºè®® - åŸºäº BestBlogs æµç¨‹åˆ†æ

## ğŸ“Š ä¼˜ç§€é¡¹ç›®å…³é”®è®¾è®¡åˆ†æ

### å›¾1ï¼šä¸»æµç¨‹ (4é˜¶æ®µæµæ°´çº¿)

```
RSSæº â†’ çˆ¬å– â†’ åˆè¯„ â†’ åˆ†æ â†’ ç¿»è¯‘ â†’ å·²å¤„ç†æ–‡ç« 
```

**æ ¸å¿ƒè®¾è®¡**ï¼š
1. **åˆ†é˜¶æ®µæµæ°´çº¿**ï¼š4ä¸ªç‹¬ç«‹é˜¶æ®µï¼Œæ¯é˜¶æ®µæœ‰ç‹¬ç«‹é˜Ÿåˆ—å’Œå®šæ—¶å™¨
2. **æ¨¡å‹åˆ†å±‚ç­–ç•¥**ï¼š
   - åˆè¯„ï¼šä¸­å°æ¨¡å‹ï¼ˆæ€§ä»·æ¯”ä¼˜å…ˆï¼‰
   - åˆ†æ/ç¿»è¯‘ï¼šä¸­é«˜æ¨¡å‹ï¼ˆæ•ˆæœä¼˜å…ˆï¼‰
3. **é•¿æ–‡åˆ†æ®µ**ï¼š>6000å­—ç¬¦è‡ªåŠ¨åˆ†æ®µå¤„ç†
4. **è´¨é‡å…³å¡**ï¼šåˆè¯„å…³å¡ã€åˆ†æå…³å¡ï¼ˆä¸é€šè¿‡åˆ™åºŸå¼ƒï¼‰
5. **ä¸“æœ‰åè¯è¯†åˆ«**ï¼šç¿»è¯‘å‰æå–ä¸“æœ‰åè¯

### å›¾2ï¼šåˆè¯„æµç¨‹ (è¯­è¨€åˆ†æ”¯)

```
å¼€å§‹ â†’ è·å–æ–‡ç«  â†’ è§£æ â†’ åˆ¤æ–­è¯­è¨€ â†’ ä¸­æ–‡(DeepSeek) / è‹±æ–‡(Gemini) â†’ è¿”å›ç»“æœ
```

**æ ¸å¿ƒè®¾è®¡**ï¼š
1. **è¯­è¨€åˆ¤æ–­åˆ†æ”¯**ï¼šä¸­æ–‡ç”¨DeepSeekï¼Œè‹±æ–‡ç”¨Gemini
2. **ç»“æ„åŒ–ç»“æœ**ï¼š
   ```json
   {
     "ignore": false,
     "reason": "æ·±å…¥æ¢è®¨ç¾å›¢æœç´¢å¹¿å‘Šå¬å›æŠ€æœ¯...",
     "value": 5,
     "summary": "æ–‡ç« è¯¦ç»†ä»‹ç»äº†...",
     "language": "ä¸­æ–‡"
   }
   ```
3. **æ¨¡å‹ä¸“ç²¾åŒ–**ï¼šä¸åŒè¯­è¨€ä½¿ç”¨å¯¹åº”æ“…é•¿æ¨¡å‹

### å›¾3ï¼šåˆ†ææµç¨‹ (çŸ­æ–‡/é•¿æ–‡åˆ†æ”¯)

```
å¼€å§‹ â†’ è·å–æ–‡ç«  â†’ è§£æ â†’ åˆ¤æ–­é•¿åº¦
                                  â†“
                    çŸ­æ–‡(â‰¤6000)         é•¿æ–‡(>6000)
                          â†“                   â†“
                    åˆ†æ®µâ†’é€ä¸ªåˆ†æ          å…¨æ–‡åˆ†æ
                          â†“                   â†“
                          åˆå¹¶ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                    ç»¼åˆåˆ†æ â†’ å˜é‡èšåˆ â†’ æå–æ ‡ç­¾ â†’ åé¦ˆæ”¹è¿› â†’ ç»“æœ
```

**æ ¸å¿ƒè®¾è®¡**ï¼š
1. **çŸ­æ–‡/é•¿æ–‡åŒè·¯å¾„**ï¼š
   - çŸ­æ–‡(â‰¤6000)ï¼šåˆ†æ®µâ†’é€ä¸ªåˆ†æâ†’åˆå¹¶
   - é•¿æ–‡(>6000)ï¼šå…¨æ–‡åˆ†æ
2. **å¤šæ¨¡å‹ååŒ**ï¼š
   - deepseek-chatï¼šæ®µè½/å…¨æ–‡åˆ†æ
   - Gemini 1.5 Proï¼šåé¦ˆä¼˜åŒ–
3. **åé¦ˆæ”¹è¿›æœºåˆ¶**ï¼šæ ¹æ®ç”¨æˆ·åé¦ˆä¼˜åŒ–æ‘˜è¦å’Œæ ‡ç­¾
4. **å˜é‡èšåˆå™¨**ï¼šç»“æ„åŒ–è¾“å‡º

---

## ğŸ†š å¯¹æ¯”åˆ†æ

| è®¾è®¡ç»´åº¦ | BestBlogs | Rss-Easy å½“å‰å®ç° | å»ºè®® |
|---------|-----------|------------------|------|
| **åˆ†é˜¶æ®µæµæ°´çº¿** | âœ… 4ä¸ªç‹¬ç«‹é˜¶æ®µ | âœ… åŸºç¡€åˆ†æ+æ·±åº¦åˆ†æåˆ†ç¦» | éœ€å¢åŠ ç¿»è¯‘é˜¶æ®µ |
| **æ¨¡å‹åˆ†å±‚** | âœ… åˆè¯„ç”¨ä¸­å°æ¨¡å‹ | âš ï¸ ç»Ÿä¸€ä½¿ç”¨é»˜è®¤æ¨¡å‹ | éœ€å¢åŠ åˆè¯„æ¨¡å‹é€‰æ‹© |
| **è¯­è¨€åˆ†æ”¯** | âœ… ä¸­æ–‡/è‹±æ–‡ä¸åŒæ¨¡å‹ | âŒ æœªå®ç° | **å»ºè®®å®ç°** |
| **çŸ­æ–‡/é•¿æ–‡åˆ†æ”¯** | âœ… â‰¤6000åˆ†æ®µç­–ç•¥ | âœ… å·²å®ç°åˆ†æ®µ | å¯ä¼˜åŒ–é˜ˆå€¼ |
| **è´¨é‡å…³å¡** | âœ… åˆè¯„å…³å¡+åˆ†æå…³å¡ | âš ï¸ ä»…æ·±åº¦åˆ†æ | **å»ºè®®å¢åŠ åˆè¯„å…³å¡** |
| **ä¸“æœ‰åè¯å¤„ç†** | âœ… ç¿»è¯‘å‰è¯†åˆ« | âŒ æœªå®ç° | å¯é€‰å®ç° |
| **åé¦ˆæ”¹è¿›** | âœ… å¤šè½®åé¦ˆä¼˜åŒ– | âœ… åæ€å¼•æ“ | å¯å¢åŠ ç”¨æˆ·åé¦ˆ |
| **ç»“æ„åŒ–è¾“å‡º** | âœ… JSONæ ‡å‡†åŒ– | âœ… Prisma Schema | å·²å®ç° |

---

## ğŸ¯ æ”¹è¿›å»ºè®®

### ä¼˜å…ˆçº§ 1ï¼šå¢åŠ åˆè¯„å…³å¡ (CRITICAL)

**é—®é¢˜**ï¼šå½“å‰å®ç°ç¼ºå°‘åˆè¯„è¿‡æ»¤ï¼Œæ‰€æœ‰æ–‡ç« éƒ½è¿›å…¥æ·±åº¦åˆ†æé˜Ÿåˆ—ï¼Œæµªè´¹èµ„æºã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

```typescript
// lib/ai/preliminary-evaluator.ts
export class PreliminaryEvaluator {
  constructor(
    private llm: LLMService,
    private modelConfig: {
      chineseModel: string;  // 'deepseek-chat'
      englishModel: string;   // 'gemini-1.5-pro'
    }
  ) {}

  async evaluate(entry: Entry): Promise<PreliminaryEvaluation> {
    // 1. è¯­è¨€æ£€æµ‹
    const language = await this.detectLanguage(entry.content);

    // 2. é€‰æ‹©å¯¹åº”æ¨¡å‹
    const model = language === 'zh' ? this.modelConfig.chineseModel : this.modelConfig.englishModel;

    // 3. åˆè¯„
    const evaluation = await this.llm.generate(
      this.buildPrompt(entry, language),
      { model }
    );

    return {
      ignore: evaluation.ignore,      // æ˜¯å¦å¿½ç•¥
      reason: evaluation.reason,       // åŸå› 
      value: evaluation.value,         // ä»·å€¼è¯„åˆ† 1-5
      summary: evaluation.summary,     // ä¸€å¥è¯æ€»ç»“
      language,                        // è¯­è¨€
    };
  }

  private buildPrompt(entry: Entry, language: string): string {
    return `
ä½ æ˜¯æ–‡ç« åˆè¯„ä¸“å®¶ï¼Œè¯·è¯„ä¼°ä»¥ä¸‹æ–‡ç« æ˜¯å¦å€¼å¾—æ·±å…¥é˜…è¯»ã€‚

æ ‡é¢˜ï¼š${entry.title}
å†…å®¹ï¼š${entry.content.slice(0, 2000)}...

è¯·è¿”å›JSONæ ¼å¼ï¼š
{
  "ignore": boolean,     // æ˜¯å¦å¿½ç•¥ï¼ˆå¹¿å‘Šã€ä½è´¨å†…å®¹ï¼‰
  "reason": string,      // ä¸»é¢˜æè¿°
  "value": number,       // ä»·å€¼è¯„åˆ† 1-5
  "summary": string,     // ä¸€å¥è¯æ€»ç»“ï¼ˆ50å­—å†…ï¼‰
  "language": string     // è¯­è¨€ç±»å‹
}
`;
  }
}
```

**æ•°æ®åº“æ‰©å±•**ï¼š

```prisma
model Entry {
  // ... ç°æœ‰å­—æ®µ

  // åˆè¯„å­—æ®µ
  aiPrelimIgnore      Boolean?  @map("ai_prelim_ignore")
  aiPrelimReason      String?   @map("ai_prelim_reason")
  aiPrelimValue       Int?      @map("ai_prelim_value")
  aiPrelimSummary     String?   @map("ai_prelim_summary")
  aiPrelimLanguage    String?   @map("ai_prelim_language")
  aiPrelimAnalyzedAt  DateTime? @map("ai_prelim_analyzed_at")
}
```

**æµç¨‹è°ƒæ•´**ï¼š

```
åŸæµç¨‹ï¼š
çˆ¬å– â†’ åŸºç¡€AI â†’ æ·±åº¦åˆ†æé˜Ÿåˆ—

æ–°æµç¨‹ï¼š
çˆ¬å– â†’ åˆè¯„é˜Ÿåˆ— â†’ (é€šè¿‡) â†’ æ·±åº¦åˆ†æé˜Ÿåˆ—
              â†“
           (ä¸é€šè¿‡) â†’ æ ‡è®°åºŸå¼ƒ
```

---

### ä¼˜å…ˆçº§ 2ï¼šè¯­è¨€åˆ†æ”¯æ¨¡å‹é€‰æ‹© (HIGH)

**é—®é¢˜**ï¼šå½“å‰æ‰€æœ‰æ–‡ç« ä½¿ç”¨ç»Ÿä¸€æ¨¡å‹ï¼Œæœªé’ˆå¯¹ä¸åŒè¯­è¨€ä¼˜åŒ–ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

```typescript
// lib/ai/model-selector.ts
export interface ModelConfig {
  chinese: {
    preliminary: string;  // 'deepseek-chat'
    analysis: string;     // 'deepseek-chat'
    reflection: string;   // 'deepseek-chat'
  };
  english: {
    preliminary: string;  // 'gemini-1.5-pro'
    analysis: string;     // 'gemini-1.5-pro'
    reflection: string;   // 'gpt-4o'
  };
  other: {
    preliminary: string;  // 'gpt-4o-mini'
    analysis: string;     // 'gpt-4o'
    reflection: string;   // 'gpt-4o'
  };
}

export class ModelSelector {
  constructor(private config: ModelConfig) {}

  selectModel(language: string, stage: 'preliminary' | 'analysis' | 'reflection'): string {
    const langKey = this.getLangKey(language);
    return this.config[langKey][stage];
  }

  private getLangKey(language: string): 'chinese' | 'english' | 'other' {
    if (language.startsWith('zh')) return 'chinese';
    if (language.startsWith('en')) return 'english';
    return 'other';
  }
}
```

---

### ä¼˜å…ˆçº§ 3ï¼šçŸ­æ–‡/é•¿æ–‡åŒè·¯å¾„ (MEDIUM)

**é—®é¢˜**ï¼šå½“å‰æ‰€æœ‰æ–‡ç« éƒ½ä½¿ç”¨åˆ†æ®µç­–ç•¥ï¼ŒçŸ­æ–‡å¯ç®€åŒ–å¤„ç†ã€‚

**å½“å‰å®ç°**ï¼š
```typescript
// æ‰€æœ‰æ–‡ç« éƒ½åˆ†æ®µ
const analyzer = new SegmentedAnalyzer(llm);
```

**æ”¹è¿›æ–¹æ¡ˆ**ï¼š
```typescript
// lib/ai/analysis/smart-analyzer.ts
export class SmartAnalyzer {
  async analyze(entry: Entry) {
    const wordCount = this.countWords(entry.content);

    if (wordCount <= 6000) {
      // çŸ­æ–‡ï¼šç›´æ¥åˆ†æ
      return this.directAnalysis(entry);
    } else {
      // é•¿æ–‡ï¼šåˆ†æ®µåˆ†æ
      return this.segmentedAnalysis(entry);
    }
  }

  private async directAnalysis(entry: Entry) {
    // ç›´æ¥è°ƒç”¨ LLM åˆ†æï¼Œæ— éœ€åˆ†æ®µ
    return this.llm.generate(this.buildDirectPrompt(entry));
  }

  private async segmentedAnalysis(entry: Entry) {
    // ä½¿ç”¨ç°æœ‰çš„ SegmentedAnalyzer
    const analyzer = new SegmentedAnalyzer(this.llm);
    return analyzer.analyze(entry.content, entry);
  }
}
```

---

### ä¼˜å…ˆçº§ 4ï¼šåé¦ˆæ”¹è¿›æœºåˆ¶ (LOW)

**é—®é¢˜**ï¼šå½“å‰åæ€å¼•æ“ä»…åŸºäºè‡ªæˆ‘è¯„ä¼°ï¼Œæœªçº³å…¥ç”¨æˆ·åé¦ˆã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

```typescript
// lib/ai/analysis/feedback-engine.ts
export class FeedbackEngine {
  async improveWithFeedback(
    entryId: string,
    currentAnalysis: AnalysisResult,
    userFeedback?: UserFeedback
  ): Promise<ImprovedResult> {

    let improvedAnalysis = currentAnalysis;

    // 1. è‡ªæˆ‘åæ€
    const reflection = new ReflectionEngine(this.llm);
    improvedAnalysis = await reflection.refine(
      entry.content,
      improvedAnalysis,
      2
    );

    // 2. ç”¨æˆ·åé¦ˆæ•´åˆ
    if (userFeedback) {
      improvedAnalysis = await this.applyUserFeedback(
        improvedAnalysis,
        userFeedback
      );
    }

    return improvedAnalysis;
  }

  private async applyUserFeedback(
    analysis: AnalysisResult,
    feedback: UserFeedback
  ): Promise<AnalysisResult> {
    return this.llm.generate(`
å½“å‰åˆ†æç»“æœï¼š
${JSON.stringify(analysis)}

ç”¨æˆ·åé¦ˆï¼š
- æ‘˜è¦é—®é¢˜ï¼š${feedback.summaryIssue}
- æ ‡ç­¾å»ºè®®ï¼š${feedback.tagSuggestions}

è¯·æ ¹æ®ç”¨æˆ·åé¦ˆä¼˜åŒ–åˆ†æç»“æœã€‚
    `);
  }
}
```

---

## ğŸ“‹ å®æ–½è®¡åˆ’

### Phase 1: åˆè¯„å…³å¡ (1-2å¤©)
1. âœ… åˆ›å»º `PreliminaryEvaluator` ç±»
2. âœ… æ‰©å±• Prisma Schema
3. âœ… åˆ›å»ºåˆè¯„é˜Ÿåˆ— `preliminary-analysis-queue`
4. âœ… æ›´æ–° Worker é€»è¾‘
5. âœ… æ·»åŠ  API è·¯ç”±

### Phase 2: è¯­è¨€åˆ†æ”¯ (1å¤©)
1. âœ… åˆ›å»º `ModelSelector` ç±»
2. âœ… æ›´æ–°ç°æœ‰åˆ†æå™¨é›†æˆ
3. âœ… æ·»åŠ è¯­è¨€æ£€æµ‹å·¥å…·

### Phase 3: çŸ­æ–‡ä¼˜åŒ– (1å¤©)
1. âœ… åˆ›å»º `SmartAnalyzer` ç±»
2. âœ… æ›´æ–°åˆ†ææµç¨‹

### Phase 4: åé¦ˆæœºåˆ¶ (å¯é€‰ï¼Œ2å¤©)
1. âœ… åˆ›å»º `FeedbackEngine` ç±»
2. âœ… æ·»åŠ ç”¨æˆ·åé¦ˆ API
3. âœ… å‰ç«¯åé¦ˆç»„ä»¶

---

## ğŸ¯ é¢„æœŸæ•ˆæœ

| æŒ‡æ ‡ | å½“å‰ | æ”¹è¿›å | æå‡ |
|------|------|--------|------|
| åˆè¯„é€šè¿‡ç‡ | N/A | ~60% | è¿‡æ»¤ä½è´¨å†…å®¹ |
| æ·±åº¦åˆ†ææˆæœ¬ | 100% | ~60% | **èŠ‚çœ40%æˆæœ¬** |
| ä¸­æ–‡åˆ†æå‡†ç¡®ç‡ | ~85% | ~92% | +7% |
| è‹±æ–‡åˆ†æå‡†ç¡®ç‡ | ~75% | ~90% | **+15%** |
| çŸ­æ–‡å¤„ç†é€Ÿåº¦ | 30s | 15s | **å¿«50%** |

---

## ğŸ”„ å®Œæ•´æµç¨‹å¯¹æ¯”

### æ”¹è¿›å‰æµç¨‹
```
RSS â†’ çˆ¬å– â†’ å­˜å‚¨ â†’ åŸºç¡€AI â†’ æ·±åº¦åˆ†æé˜Ÿåˆ— â†’ Worker â†’ åˆ†æ®µåˆ†æ â†’ åæ€ â†’ è¯„åˆ† â†’ å­˜å‚¨
```

### æ”¹è¿›åæµç¨‹
```
RSS â†’ çˆ¬å– â†’ å­˜å‚¨ â†’ åˆè¯„é˜Ÿåˆ— â†’ Worker â†’ è¯­è¨€æ£€æµ‹ â†’ (ä¸­æ–‡/è‹±æ–‡) â†’ åˆè¯„
                                          â†“
                                    é€šè¿‡ â†’ æ·±åº¦åˆ†æé˜Ÿåˆ— â†’ Worker â†’ çŸ­æ–‡/é•¿æ–‡åˆ†æ”¯
                                          â†“
                                    ä¸é€šè¿‡ â†’ æ ‡è®°åºŸå¼ƒ
```

---

## ğŸ“ ä»£ç å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶
- `lib/ai/preliminary-evaluator.ts`
- `lib/ai/model-selector.ts`
- `lib/ai/smart-analyzer.ts`
- `lib/ai/feedback-engine.ts`
- `lib/queue/preliminary-processor.ts`
- `server/api/preliminary.ts`

### ä¿®æ”¹æ–‡ä»¶
- `prisma/schema.prisma` (æ·»åŠ åˆè¯„å­—æ®µ)
- `lib/queue/deep-analysis-processor.ts` (æ·»åŠ è¯­è¨€åˆ¤æ–­)
- `lib/ai/analysis/segmented-analyzer.ts` (é›†æˆçŸ­æ–‡è·¯å¾„)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æ›´æ–°æ•°æ®åº“
```bash
npm run db:generate
npm run db:push
```

### 2. é…ç½®æ¨¡å‹
```env
# åˆè¯„æ¨¡å‹ï¼ˆä½æˆæœ¬ï¼‰
PRELIMINARY_MODEL_CHINESE=deepseek-chat
PRELIMINARY_MODEL_ENGLISH=gemini-1.5-pro

# åˆ†ææ¨¡å‹ï¼ˆé«˜è´¨é‡ï¼‰
ANALYSIS_MODEL_CHINESE=deepseek-chat
ANALYSIS_MODEL_ENGLISH=gemini-1.5-pro

# åæ€æ¨¡å‹ï¼ˆæœ€é«˜è´¨é‡ï¼‰
REFLECTION_MODEL_CHINESE=deepseek-chat
REFLECTION_MODEL_ENGLISH=gpt-4o
```

### 3. å¯åŠ¨æœåŠ¡
```bash
# ç»ˆç«¯1ï¼šä¸»åº”ç”¨
npm run dev

# ç»ˆç«¯2ï¼šåˆè¯„é˜Ÿåˆ—
npm run worker:preliminary

# ç»ˆç«¯3ï¼šæ·±åº¦åˆ†æé˜Ÿåˆ—
npm run worker:deep-analysis
```

---

**æ€»ç»“**ï¼šé€šè¿‡å¼•å…¥åˆè¯„å…³å¡ã€è¯­è¨€åˆ†æ”¯å’ŒçŸ­æ–‡ä¼˜åŒ–ï¼Œé¢„è®¡å¯èŠ‚çœ40%åˆ†ææˆæœ¬ï¼ŒåŒæ—¶æå‡å¤šè¯­è¨€åˆ†æå‡†ç¡®ç‡15%ä»¥ä¸Šã€‚
